# dotfiles

Date: 2020-04-15
Speaker: Hiroshi Nishigami (hnishi)

---

## è¿‘æ³

[HHKB (Happy Hacking Keyboard)](https://www.pfu.fujitsu.com/direct/hhkb/detail_pd-kb800bs.html)
ã‚’è²·ã„ã¾ã—ãŸã€‚ :money_with_wings:

<img src="https://www.pfu.fujitsu.com/direct/hhkb/images/detail_pd-kb800bs-1.jpg" width="50%" style="background:none; border:none; box-shadow:none;">

---

## ã¯ã˜ã‚ã«

æœ€è¿‘ï¼ˆå»å¹´ï¼‘ï¼’æœˆé ƒâ›„ï¸ï¼‰ã€ [è‡ªåˆ†ã® dotfiles ã‚’æ•´ç†ã—ãŸ](https://qiita.com/hnishi/items/28ad11df1dde8b0ed368) ãŸã‚ã€å…±æœ‰ã—ã‚ˆã†ã¨æ€ã„ã¾ã—ãŸã€‚
ï¼ˆ+ 3 ãƒ¶æœˆãã‚‰ã„ä½¿ã£ã¦ã¿ã¦ã€ã¡ã‚‡ã£ã¨ã ã‘ãƒã‚¦ãƒã‚¦ãŒãŸã¾ã£ãŸã®ã§ï¼‰

---

## å¯¾è±¡

ã‚¿ãƒ¼ãƒŸãƒŠãƒ« (CLI) åˆå­¦è€…å‘ã‘ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

---

## dotfiles ã¨ã¯

- unix-like systems ã«ãŠã‘ã‚‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ã“ã¨ã€‚
- ãƒ•ã‚¡ã‚¤ãƒ«åãŒãƒ‰ãƒƒãƒˆ . ã‹ã‚‰å§‹ã¾ã‚‹ã“ã¨ã«ç”±æ¥ã€‚

---

## dotfiles ã®ä¾‹

- .bash_profile
- .bashrc
- .zshrc
- .asdfrc
- .gitconfig
- .vimrc

---

## Catalina ã‹ã‚‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚·ã‚§ãƒ«ãŒ bash ğŸ‘‰ zsh ã«å¤‰ã‚ã£ãŸ

- Mojave ã§ã¯ Bash 3.2 (GNU Bash) (2007å¹´ã‹ã‚‰)
- ãªãŠã€bash ã®é–‹ç™ºã¯ active ã§ç¾åœ¨ version 5.0
- æ–°ã—ã„ bash ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯ GPLv3
- GPLv3 ã®åˆ¶é™ãŒå³ã—ã„ï¼ˆç‹¬è‡ªã‚½ãƒ•ãƒˆã§ã®ä½¿ç”¨ç¦æ­¢ã€ç‰¹è¨±çµ¡ã¿ã®å•é¡Œï¼‰
- ã¡ãªã¿ã«ã€zsh ã¯ MIT License

https://thenextweb.com/dd/2019/06/04/why-does-macos-catalina-use-zsh-instead-of-bash-licensing/

---

## dotfiles ã®ä½•ã‚’è©±ã™ã®ã‹

TODO: ãƒ¡ãƒªãƒƒãƒˆã«ã¤ã„ã¦è©±ã™

ã€Œç’°å¢ƒæ§‹ç¯‰ã§æ¶ˆè€—ã—ã¦ã„ã¾ã›ã‚“ã‹ï¼Ÿã€

---

## ç®¡ç†æ‰‹æ³•ãŒéå¸¸ã«å¤šå²ã«ã‚ãŸã£ã¦ã„ã‚‹

ã¡ã‚‡ã£ã¨æ¤œç´¢ã—ãŸã ã‘ã§ã‚‚ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ã”ã¨ã«è‰²ãŒå‡ºéãã¦ã„ã‚‹ã€‚

---

## ãŸã¨ãˆã°

- [ãƒ›ãƒ¼ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ã¾ã‚‹ã”ã¨ git ã§ç®¡ç†ã™ã‚‹æ–¹æ³•](https://medium.com/toutsbrasil/how-to-manage-your-dotfiles-with-git-f7aeed8adf8b)
- [make](https://qiita.com/b4b4r07/items/b70178e021bef12cd4a2)
- [ruby](https://medium.com/@webprolific/getting-started-with-dotfiles-43c3602fd789)
- [python](https://pypi.org/project/dotfiles/)

---

## ç§ã® dotfiles æˆ¦ç•¥

- æœ€å°æ§‹æˆã®ã‚µãƒ¼ãƒãƒ¼ã«å¯¾ã—ã¦ã‚‚ã€ã™ãã«dotfilesã‚’å±•é–‹ã§ãã‚‹
- Mac, Linux, Windows (mintty) ã«å¯¾å¿œ

---

## æ–¹é‡

- ã§ãã‚‹ã ã‘ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆã«ã™ã‚‹
- bash ä¾å­˜ã®ã¿

---

## æˆæœç‰©

https://github.com/hnishi/dotfiles

---

## å·¥å¤«

ãƒ¯ãƒ³ãƒ©ã‚¤ãƒ³ã®ã‚³ãƒãƒ³ãƒ‰ä¸€ç™ºã§ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’è¡Œãˆã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸ

---

## ãƒ™ãƒ¼ã‚¹

[bash ã ã‘ã§å±•é–‹ã§ãã‚‹æœ€å°æ§‹æˆã® dotfiles ãƒ¬ãƒã‚¸ãƒˆãƒª](https://github.com/yutakatay/dotfiles-mini) ã‚’å‚è€ƒã«ã•ã›ã¦ã‚‚ã‚‰ã„ã¾ã—ãŸã€‚

---

## ä½¿ã„æ–¹

```
curl -L raw.githubusercontent.com/hnishi/dotfiles/master/scripts/download.sh | bash
```

[code](https://github.com/hnishi/dotfiles/blob/master/scripts/download.sh)

---

## git ãŒã‚ã‚‹å ´åˆ

```bash
    if is_exists "git"; then
    # --recursive equals to ...
    # git submodule init
    # git submodule update
    git clone --recursive "$DOTFILES_GITHUB" "$DOTPATH"
```

---

## curl ãŒã‚ã‚‹å ´åˆ

```
    elif is_exists "curl" || is_exists "wget"; then
    # curl or wget
    local tarball="https://github.com/hnishi/dotfiles/archive/master.tar.gz"
    if is_exists "curl"; then
    curl -L "$tarball"
```

---

## wget ãŒã‚ã‚‹å ´åˆ

```bash
    elif is_exists "wget"; then
    wget -O - "$tarball"

    fi | tar xvz
    if [ ! -d dotfiles-master ]; then
    log_fail "dotfiles-master: not found"
    exit 1
    fi
    command mv -f dotfiles-master "$DOTPATH"
```

---

## dotfiles ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ä»•çµ„ã¿

ãƒ¬ãƒã‚¸ãƒˆãƒªã«å­˜åœ¨ã™ã‚‹ . (ãƒ‰ãƒƒãƒˆ) ã‹ã‚‰å§‹ã¾ã‚‹ãƒ•ã‚¡ã‚¤ãƒ« or ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«é–¢ã—ã¦ã€
æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’å–ã£ã¦ã€ãƒ›ãƒ¼ãƒ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚’è²¼ã‚‹

---

```bash
    if [[ "$HOME" != "$dotdir" ]];then
    for f in $dotdir/.??*; do
      [[ `basename $f` == ".git" ]] && continue
      if [[ -L "$HOME/`basename $f`" ]];then
        command rm -f "$HOME/`basename $f`"
      fi
      if [[ -e "$HOME/`basename $f`" ]];then
        command mv --backup=numbered "$HOME/`basename $f`" "$HOME/.gdotbackup"
      fi
      command ln -snf $f $HOME
    done
```

[code](https://github.com/hnishi/dotfiles/blob/50e37693a3f12dc2ff5e6f50257bd9ce75f6eabd/scripts/install.sh#L23-L33)

---

### TIPS

mv ã® --backup=numbered ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚Œã°ã€ç•ªå·ã‚’æŒ¯ã£ã¦ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¦ãã‚Œã¾ã™ã€‚
ç§ã¯æœ€è¿‘çŸ¥ã‚Šã¾ã—ãŸã€‚

---

## ãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œ

```bash
$ ls -a ~/.bashrc*
/Users/hnishi/.bashrc
/Users/hnishi/.bashrc_local
/Users/hnishi/.bashrc_linux
/Users/hnishi/.bashrc_mac
```

---

## bash è¨­å®šã®èª­ã¿è¾¼ã¿ã®æµã‚Œ

<img src="images/source_tree.png" style="background:none; border:none; box-shadow:none;">

---

## .bash_profile ã¨ .bashrc ã®é•ã„

TODO: magicant ã•ã‚“ã®è¨˜äº‹ã‚’å¼•ç”¨ã™ã‚‹

---

## ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

- ã‚ã¾ã‚Šã‚¤ã‚±ã¦ãªã„
- exit status ã«ã‚ˆã‚‹è‰²ä»˜ã‘ã€å®Ÿè¡Œæ™‚é–“ã€ç¾åœ¨æ™‚åˆ»ãªã©

<img src="images/ps1.png" style="background:none; border:none; box-shadow:none;">

---

## ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

bash ã ã¨ PROMPT_COMMAND ã«é–¢æ•°ã‚’æŒ‡å®šã™ã‚‹ã¨ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¡¨ç¤ºæ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚

```bash
dispatch () {
  local EXIT_STATUS="$?" # ç›´å‰ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œçµæœã®ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã‚’ä¿å­˜
  timer_stop # ç›´å‰ã®ã‚³ãƒãƒ³ãƒ‰ã®å‡¦ç†æ™‚é–“ã‚’å›³ã‚‹ãŸã‚ã®ã‚¿ã‚¤ãƒãƒ¼(é–¢æ•°)
  get_datetime # ç¾åœ¨æ™‚åˆ»ã‚’å–å¾—ã™ã‚‹é–¢æ•°

  local status_color="" # exit status ã«ã‚ˆã£ã¦è‰²ã‚’å¤‰ãˆã‚‹
  if [ $EXIT_STATUS != 0 ]; then
    status_color=$PALE_RED
  else
    status_color=$DARK_GREEN
  fi
  export PS1="${GREEN}${PS1_USER}${WHITE}:${PALE_BLUE}\w${CYAN}$(__git_ps1) ${status_color} [exit: \$?] ${WHITE}[last: ${timer_show}s] [${prompt_datetime}]\n\$ "
}
export PROMPT_COMMAND=dispatch
```

[code](https://github.com/hnishi/dotfiles/blob/50e37693a3f12dc2ff5e6f50257bd9ce75f6eabd/.bashrc#L131-L155)

---

## çµæœ

bash + {git,curl,wget}
ãŒã‚ã‚Œã°å³åº§ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™

---

## bash ã ã‘ã§ã‚‚ TCP é€šä¿¡ãŒã§ãã‚‹ã‚‰ã—ã„

ã‚‚ã—ã‹ã™ã‚‹ã¨ã€curl ã‚‚ä½¿ã‚ãªãã¦ã‚‚ã„ã„ã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ã“ã‚Œã¯è©¦ã—ã¦ãªã„ã§ã™ã€‚

```bash
exec 3<>/dev/tcp/www.google.com/80
echo -e "GET / HTTP/1.1\r\nhost: http://www.google.com\r\nConnection: close\r\n\r\n" >&3
cat <&3
```

https://www.linuxjournal.com/content/more-using-bashs-built-devtcp-file-tcpip

---

## ä½¿ã„ã‚„ã™ã„ã‚ˆã†ã« template ã‚’ä½œæˆã—ã¾ã—ãŸ

ä»¥ä¸‹ã«ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹ã¨ã€ãƒ¬ãƒã‚¸ãƒˆãƒªã« dotfiles ã‚’é…ç½®ã™ã‚‹ã ã‘ã§ä½¿ãˆã¾ã™
(bashã®ã¿å¯¾å¿œ)ã€‚

https://github.com/hnishi/dotfiles/releases/tag/minimal-template-v0

---

## ã¾ã¨ã‚

- dotfiles ã¯è‚²ã¦ã¦ã„ãæ„Ÿè¦šãŒã‚ã£ã¦æ¥½ã—ã„ ğŸ˜ƒ

---

# ãŠã¾ã‘

---

## VS Code

(PC ã”ã¨ã® path ç­‰ãŒè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«å…¥ã£ã¦ãã‚‹ã®ã§çµæ§‹é¢å€’)

[Visual Studio Code ãŒå…¬å¼ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«åŒæœŸãƒ„ãƒ¼ãƒ«ã‚’ç™ºè¡¨](https://code.visualstudio.com/updates/v1_43#_settings-sync)
(ç¾åœ¨ preview ç‰ˆã®ã¿)

ã¾ã ä½¿ã£ãŸã“ã¨ã¯ãªã„ã§ã™ãŒã€æœŸå¾…ã€‚
ãƒã‚¤ã‚¯ãƒ­ã‚½ãƒ•ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¸ã® sign in ãŒå¿…è¦ã¿ãŸã„ã€‚

https://code.visualstudio.com/docs/editor/settings-sync

---

## ãŠã™ã™ã‚ã® Theme

ç°¡å˜ã«ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¨­å®š

- [starship](https://github.com/starship/starship)
  - bash fish, zsh, powershell, Ion ã«å¯¾å¿œ
- [powerlevel10k](https://github.com/romkatv/powerlevel10k)
  - zsh ã®ã¿å¯¾å¿œ

---

## starship

<video src="https://starship.rs/demo.webm" width="80%"></video>

https://starship.rs/

---

## powerlevel10k

<img src="https://raw.githubusercontent.com/romkatv/powerlevel10k-media/master/prompt-styles-high-contrast.png" width="70%" style="background:none; border:none; box-shadow:none;">

https://github.com/romkatv/powerlevel10k

---

TODO: https://qiita.com/yutakatay/items/c6c7584d9795799ee164#%E4%BB%8A%E3%81%99%E3%81%90%E3%81%AB%E3%81%A7%E3%82%82%E5%A7%8B%E3%82%81%E3%82%89%E3%82%8C%E3%82%8B%E6%9C%80%E5%B0%8Fdotfiles%E3%81%AE%E4%BD%9C%E3%82%8A%E6%96%B9 èª­ã‚“ã§å†…å®¹ã‚’ã™ã“ã—å¼•ç”¨ã™ã‚‹
